CREATE DEFINER=`root`@`localhost` PROCEDURE `spAdjustStockQuantity`(
  IN id Int
)
BEGIN
  #Routine body goes here...
--   IF EXISTS (SELECT 1 from stock where StockID = id) THEN SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'StockID is present,Request to check another stock';
--   END IF;
  IF Exists(SELECT 1 from `transaction` where StockID!=id) THEN SIGNAL SQLSTATE  '45000' SET MESSAGE_TEXT= 'these stock is not present';
  END IF;
  UPDATE stock st set st.TotalAvalibleQuantity = (st.TotalAvalibleQuantity - (SELECT TotalQunaity from `transaction` where StockId = id) ) ;
END